---
"kiro-agents": minor
---

# Reduce context overhead with protocol extraction and injection system

Extracted large instruction blocks from always-loaded steering documents into separate protocol files (.mdx), reducing context overhead by ~312 lines. Implemented build-time protocol injection system with target-aware substitutions, enabling single source of truth for agent management workflows while maintaining minimal footprint in AI context.

## Added
- Protocol files for agent activation, mode switching, agent management, and agent creation
- Build-time protocol injection system with `injectProtocol()` helper function
- Target-aware substitutions that generate different paths for npm vs power distributions
- Comprehensive guide files for agent system and modes system
- `{{{PROTOCOLS_PATH}}}` and `{{{AGENT_MANAGEMENT_PROTOCOL}}}` substitution placeholders

## Changed
- Steering documents reduced from ~280 lines to ~100 lines each (agent-system.md, modes-system.md)
- Alias definitions now reference external protocol files instead of inline instructions
- Substitution functions now receive build target context for dynamic path resolution
- agents.md simplified to minimal shell with protocol content injected at build time

